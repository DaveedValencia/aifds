{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://aifds.org/schemas/v1/collections.schema.json",
  "title": "AIFDS Commerce Collections (v1 draft)",
  "description": "Array of merchandising collections aligned with schema.org/CollectionPage and ItemList.",
  "type": "array",
  "minItems": 1,
  "items": {
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "@context": { "const": "https://schema.org" },
      "@type": { "const": "CollectionPage" },
      "@id": {
        "description": "Stable URI for the collection.",
        "type": "string",
        "format": "uri"
      },
      "handle": {
        "description": "Human-readable slug used in storefront URLs.",
        "type": "string",
        "pattern": "^[a-z0-9-]+$",
        "minLength": 1,
        "maxLength": 120
      },
      "name": { "type": "string", "minLength": 1 },
      "headline": { "type": "string" },
      "description": { "type": "string" },
      "url": { "type": "string", "format": "uri" },
      "image": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "@type": { "const": "ImageObject" },
          "url": { "type": "string", "format": "uri" },
          "alt": { "type": "string" }
        },
        "required": ["@type", "url"]
      },
      "filters": {
        "description": "Filter facets exposed in the collection.",
        "type": "array",
        "items": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "name": { "type": "string", "minLength": 1 },
            "type": { "enum": ["list", "price", "boolean", "range"] },
            "values": {
              "type": "array",
              "items": { "type": "string", "minLength": 1 },
              "maxItems": 50,
              "uniqueItems": true
            }
          },
          "required": ["name", "type"]
        },
        "maxItems": 15
      },
      "sortOptions": {
        "description": "Sort orders available to shoppers (e.g., price ascending).",
        "type": "array",
        "items": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "name": { "type": "string", "minLength": 1 },
            "code": { "type": "string", "minLength": 1 },
            "default": { "type": "boolean" }
          },
          "required": ["name", "code"]
        },
        "maxItems": 10
      },
      "itemList": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "@type": { "const": "ItemList" },
          "numberOfItems": { "type": "integer", "minimum": 0 },
          "itemListElement": {
            "type": "array",
            "items": {
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "@type": { "const": "ListItem" },
                "position": { "type": "integer", "minimum": 1 },
                "item": {
                  "description": "Reference to a product in product.json via @id or sku.",
                  "type": "object",
                  "additionalProperties": false,
                  "properties": {
                    "@id": { "type": "string", "minLength": 1 },
                    "sku": { "type": "string", "minLength": 1 },
                    "name": { "type": "string" },
                    "url": { "type": "string", "format": "uri" }
                  },
                  "anyOf": [
                    { "required": ["@id"] },
                    { "required": ["sku"] }
                  ]
                }
              },
              "required": ["@type", "position", "item"]
            },
            "maxItems": 250
          }
        },
        "required": ["@type", "itemListElement"]
      },
      "seo": {
        "description": "Search metadata controlling how the collection appears in SERP.",
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "metaTitle": { "type": "string", "maxLength": 70 },
          "metaDescription": { "type": "string", "maxLength": 160 }
        }
      },
      "lastModified": {
        "type": "string",
        "format": "date-time",
        "description": "Timestamp the collection payload was last regenerated."
      }
    },
    "required": ["@context", "@type", "handle", "name", "url", "itemList", "lastModified"]
  }
}
